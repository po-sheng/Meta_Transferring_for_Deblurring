# train experiment
python3 meta_main.py --save_dir ../exp/meta_train/GOPRO/reblur_exp_attn_mprnet_gan_0.99_cycle_update_n_20_patch_gopro \
               --reset True \
               --log_file_name train.log \
               --gpu_id 9 \
               --random_seed 43 \
               --num_workers 5 \
               --dataset GOPRO \
               --dataset_dir /disk1/psliu/datasets/benchMark/GOPRO_Large \
               --batch_size 1 \
               --support_optim adam \
               --optim adam \
               --meta True \
               --meta_train True \
               --reblur_lr 2.5e-6 \
               --deblur_lr 2.5e-6 \
               --use_inner_lr False \
               --inner_lr 1e-6 \
               --meta_lr 1e-7 \
               --num_epochs 3 \
               --save_every 1 \
               --img_w 1280 \
               --img_h 720 \
               --input_w 256 \
               --input_h 256 \
               --use_attn True \
               --reblur_model attn \
               --deblur_model mprnet \
               --features 32 \
               --reblur_layers 3 \
               --reblur_ratio 0.5 \
               --n_frames 5 \
               --reblur_epochs 1 \
               --gan True \
               --n_critics 1 \
               --gan_lr 1e-6 \
               --gan_ratio 0.99 \
               --find_sharp self-shift \
               --diff_method psnr \
               --reblur_backward False \
               --cycle_update False \
               --cycle_block False \
               --round False \
               --use_blurrest False \
               --support_batch 1 \
               --support_size 256 \
               --support_epochs 1 \
               --task_batch_size 1 \
               --use_reblur_pair True \
               --video_shuffle True \
               --full_img_sup False \
               --full_img_exp False \
               --use_fix_update True \
               --combine_update False \
               --n_updates 20 \
               --deblur_model_path weights/MPRNet/model_deblurring.pkl \
               --reblur_model_path ../exp/train/GOPRO/reblur_exp_attn_zero2one_gan/model/reblur_01000.pt \
               --gan_model_path ../exp/train/GOPRO/reblur_exp_attn_zero2one_gan/model/gan_01000.pt
